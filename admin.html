<!DOCTYPE html>
<html lang="zh-CN" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="My World - 后台管理">
    <title>后台管理 | My World</title>
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Custom Styles -->
    <link rel="stylesheet" href="css/style.css">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'DM Sans', sans-serif;
            background: #0A0A0F;
            color: #fff;
            min-height: 100vh;
        }
        
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .admin-header {
            margin-bottom: 30px;
        }
        
        .admin-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2.5rem;
            font-weight: 700;
            color: #00F0FF;
            margin-bottom: 10px;
        }
        
        .admin-subtitle {
            color: #B8B8C8;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }
        
        .bento-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .bento-card {
            background: linear-gradient(135deg, rgba(18, 18, 18, 0.1) 0%, rgba(18, 18, 18, 0.05) 100%);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 24px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .bento-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 240, 255, 0.2);
            border-color: rgba(0, 240, 255, 0.3);
        }
        
        .bento-card.active {
            border-color: #00F0FF;
            box-shadow: 0 0 20px rgba(0, 240, 255, 0.3);
        }
        
        .card-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #00F0FF 0%, #00B8C4 100%);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
        }
        
        .card-icon i {
            font-size: 24px;
            color: #000;
        }
        
        .card-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 8px;
        }
        
        .card-description {
            color: #B8B8C8;
            font-size: 0.9rem;
            margin-bottom: 16px;
        }
        
        .card-count {
            background: rgba(0, 240, 255, 0.1);
            border-radius: 20px;
            padding: 8px 16px;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: #00F0FF;
        }
        
        .form-container {
            background: rgba(18, 18, 18, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 24px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #E0E0E0;
        }
        
        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #fff;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #00F0FF;
            box-shadow: 0 0 0 10px rgba(0, 240, 255, 0.3);
        }
        
        .form-textarea {
            width: 100%;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            color: #fff;
            font-size: 1rem;
            font-family: 'DM Sans', sans-serif;
            resize: none;
            transition: all 0.3s ease;
            min-height: 100px;
        }
        
        .form-textarea:focus {
            outline: none;
            border-color: #00F0FF;
            box-shadow: 0 0 0 10px rgba(0, 240, 255, 0.3);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #00F0FF 0%, #00B8C4 100%);
            color: #000;
            border: none;
            border-radius: 12px;
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .btn-primary:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 240, 255, 0.4);
        }
        
        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }
        
        .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.15);
        }
        
        .item-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 16px;
            margin-top: 20px;
        }
        
        .item-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.08);
            border-radius: 16px;
            padding: 16px;
            transition: all 0.3s ease;
        }
        
        .item-card:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(0, 240, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 240, 255, 0.15);
        }
        
        .item-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 12px;
        }
        
        .item-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #00F0FF 0%, #00B8C4 100%);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .item-icon i {
            font-size: 20px;
            color: #000;
        }
        
        .item-info {
            flex: 1;
        }
        
        .item-name {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 4px;
        }
        
        .item-description {
            color: #B8B8C8;
            font-size: 0.9rem;
            margin-bottom: 12px;
        }
        
        .item-actions {
            display: flex;
            gap: 8px;
        }
        
        .btn-action {
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            flex: 1;
        }
        
        .btn-action.edit {
            background: rgba(0, 240, 255, 0.1);
            color: #00F0FF;
        }
        
        .btn-action.edit:hover {
            background: rgba(0, 240, 255, 0.15);
            transform: scale(1.05);
        }
        
        .btn-action.delete {
            background: rgba(255, 0, 230, 0.1);
            color: #FF00E6;
        }
        
        .btn-action.delete:hover {
            background: rgba(255, 0, 230, 0.15);
            transform: scale(1.05);
        }
        
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #B8B8C8;
        }
        
        .empty-state i {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .empty-state p {
            font-size: 1.2rem;
            margin-bottom: 8px;
        }
        
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .modal-overlay.active {
            display: flex;
        }
        
        .modal-content {
            background: rgba(18, 18, 18, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 32px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
        }
        
        .modal-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: #00F0FF;
        }
        
        .modal-close {
            background: rgba(255, 0, 230, 0.1);
            color: #FF00E6;
            border: none;
            border-radius: 8px;
            width: 40px;
            height: 40px;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover {
            background: rgba(255, 0, 230, 0.15);
            transform: scale(1.1);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 16px 24px;
            background: rgba(18, 18, 18, 0.95);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            z-index: 1001;
            display: none;
            align-items: center;
            gap: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .notification.success {
            border-color: #00F0FF;
        }
        
        .notification.error {
            border-color: #FF00E6;
        }
        
        .notification.show {
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }
        
        .loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 999;
            display: none;
            align-items: center;
            justify-content: center;
        }
        
        .loading.active {
            display: flex;
        }
        
        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(0, 240, 255, 0.2);
            border-top-color: #00F0FF;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }
        
        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .section-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            color: #00F0FF;
        }
    </style>
</head>
<body class="bg-[#0A0A0F] text-white min-h-screen">
    <!-- Loading Overlay -->
    <div id="loading" class="loading">
        <div class="loading-spinner"></div>
    </div>

    <!-- Notification -->
    <div id="notification" class="notification">
        <i id="notification-icon" class="fas fa-check-circle"></i>
        <span id="notification-message"></span>
    </div>

    <!-- Modal -->
    <div id="modal" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title" class="modal-title">编辑项目</h2>
                <button id="modal-close" class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="modal-body">
                <!-- Modal content will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="admin-container">
        <!-- Header -->
        <div class="admin-header">
            <a href="index.html" class="flex items-center gap-3 mb-4">
                <i class="fas fa-arrow-left text-[#00F0FF]"></i>
                <span class="text-white">返回首页</span>
            </a>
            <h1 class="admin-title">后台管理</h1>
            <p class="admin-subtitle">管理您的个人信息、项目、技能、工具和网站链接</p>
        </div>

        <!-- Bento Grid -->
        <div class="bento-grid">
            <!-- Personal Info Card -->
            <div class="bento-card" onclick="showSection('personal')">
                <div class="card-icon">
                    <i class="fas fa-user"></i>
                </div>
                <div class="card-title">个人信息</div>
                <div class="card-description">编辑您的姓名、职位、简介等个人信息</div>
                <div class="card-count" id="personal-count">1</div>
            </div>

            <!-- Projects Card -->
            <div class="bento-card" onclick="showSection('projects')">
                <div class="card-icon">
                    <i class="fas fa-project-diagram"></i>
                </div>
                <div class="card-title">项目管理</div>
                <div class="card-description">添加、编辑、删除您的项目</div>
                <div class="card-count" id="projects-count">0</div>
            </div>

            <!-- Skills Card -->
            <div class="bento-card" onclick="showSection('skills')">
                <div class="card-icon">
                    <i class="fas fa-code"></i>
                </div>
                <div class="card-title">技能管理</div>
                <div class="card-description">添加、编辑、删除您的技能</div>
                <div class="card-count" id="skills-count">0</div>
            </div>

            <!-- Tools Card -->
            <div class="bento-card" onclick="showSection('tools')">
                <div class="card-icon">
                    <i class="fas fa-tools"></i>
                </div>
                <div class="card-title">工具管理</div>
                <div class="card-description">添加、编辑、删除您的工具</div>
                <div class="card-count" id="tools-count">0</div>
            </div>

            <!-- Websites Card -->
            <div class="bento-card" onclick="showSection('websites')">
                <div class="card-icon">
                    <i class="fas fa-globe"></i>
                </div>
                <div class="card-title">网站管理</div>
                <div class="card-description">添加、编辑、删除您的网站链接</div>
                <div class="card-count" id="websites-count">0</div>
            </div>

            <!-- Stats Card -->
            <div class="bento-card" onclick="showSection('stats')">
                <div class="card-icon">
                    <i class="fas fa-chart-bar"></i>
                </div>
                <div class="card-title">统计数据</div>
                <div class="card-description">编辑您的年经验、项目完成等统计数据</div>
                <div class="card-count" id="stats-count">4</div>
            </div>
        </div>

        <!-- Section Content -->
        <div id="section-content" class="form-container">
            <!-- Content will be loaded here -->
        </div>
    </div>

    <!-- JavaScript -->
    <script src="js/main.js"></script>
    <script>
        // Admin Panel JavaScript
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Admin panel loaded');
            
            // Wait for main.js to initialize
            setTimeout(function() {
                if (!window.MyWorldAPI) {
                    console.error('MyWorldAPI not found');
                    hideLoading();
                    return;
                }
                
                console.log('MyWorldAPI loaded:', window.MyWorldAPI);
                
                // Initialize
                initAdminPanel();
            }, 100);
        });

        function initAdminPanel() {
            // Update counts
            updateCounts();
            
            // Show personal section by default
            showSection('personal');
        }

        function updateCounts() {
            if (!window.MyWorldAPI) return;
            
            const state = window.MyWorldAPI.state;
            
            document.getElementById('personal-count').textContent = '1';
            document.getElementById('projects-count').textContent = state.projects ? state.projects.length : '0';
            document.getElementById('skills-count').textContent = state.skills ? state.skills.length : '0';
            document.getElementById('tools-count').textContent = state.tools ? state.tools.length : '0';
            document.getElementById('websites-count').textContent = state.websites ? state.websites.length : '0';
            document.getElementById('stats-count').textContent = '4';
        }

        function showSection(section) {
            const sectionContent = document.getElementById('section-content');
            const bentoCards = document.querySelectorAll('.bento-card');
            
            // Remove active class from all cards
            bentoCards.forEach(function(card) {
                card.classList.remove('active');
            });
            
            // Add active class to clicked card
            const activeCard = document.querySelector('.bento-card[onclick="showSection(\'' + section + '\')"]');
            if (activeCard) {
                activeCard.classList.add('active');
            }
            
            // Load section content
            loadSectionContent(section);
        }

        function loadSectionContent(section) {
            const sectionContent = document.getElementById('section-content');
            
            switch(section) {
                case 'personal':
                    loadPersonalSection();
                    break;
                case 'projects':
                    loadProjectsSection();
                    break;
                case 'skills':
                    loadSkillsSection();
                    break;
                case 'tools':
                    loadToolsSection();
                    break;
                case 'websites':
                    loadWebsitesSection();
                    break;
                case 'stats':
                    loadStatsSection();
                    break;
            }
        }

        function loadPersonalSection() {
            const sectionContent = document.getElementById('section-content');
            const personal = window.MyWorldAPI.state.personal;
            
            if (!personal) {
                sectionContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-user-circle"></i>
                        <p>暂无个人信息</p>
                        <button onclick="showSection('personal')" class="btn-primary">添加个人信息</button>
                    </div>
                `;
                return;
            }
            
            sectionContent.innerHTML = `
                <h2 class="section-title mb-6">编辑个人信息</h2>
                <form id="personal-form" class="space-y-4">
                    <div class="form-group">
                        <label class="form-label">姓名</label>
                        <input type="text" id="name" name="name" value="${personal.name || ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">职位</label>
                        <input type="text" id="title" name="title" value="${personal.title || ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">简介</label>
                        <textarea id="description" name="description" rows="4" class="form-textarea" required>${personal.description || ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">邮箱</label>
                        <input type="email" id="email" name="email" value="${personal.email || ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">电话</label>
                        <input type="tel" id="phone" name="phone" value="${personal.phone || ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">位置</label>
                        <input type="text" id="location" name="location" value="${personal.location || ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">头像URL</label>
                        <input type="url" id="avatar" name="avatar" value="${personal.avatar || ''}" class="form-input" required>
                    </div>
                    <button type="submit" class="btn-primary">保存个人信息</button>
                </form>
            `;
            
            // Add form submit handler
            const form = document.getElementById('personal-form');
            form.addEventListener('submit', handlePersonalSubmit);
        }

        function loadProjectsSection() {
            const sectionContent = document.getElementById('section-content');
            const projects = window.MyWorldAPI.state.projects || [];
            
            if (projects.length === 0) {
                sectionContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-project-diagram"></i>
                        <p>暂无项目</p>
                        <button onclick="openModal('project')" class="btn-primary">添加项目</button>
                    </div>
                `;
                return;
            }
            
            sectionContent.innerHTML = `
                <div class="section-header">
                    <h2 class="section-title">项目管理</h2>
                    <button onclick="openModal('project')" class="btn-secondary">
                        <i class="fas fa-plus mr-2"></i>添加项目
                    </button>
                </div>
                <div class="item-list">
                    ${projects.map(function(project) {
                        return `
                        <div class="item-card">
                            <div class="item-header">
                                <div class="item-icon">
                                    <i class="fas fa-folder"></i>
                                </div>
                                <div class="item-info">
                                    <div class="item-name">${project.name}</div>
                                    <div class="item-description">${project.description}</div>
                                </div>
                                <div class="item-actions">
                                    <button onclick="openModal('project', '${project.id}')" class="btn-action edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteItem('project', '${project.id}')" class="btn-action delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function loadSkillsSection() {
            const sectionContent = document.getElementById('section-content');
            const skills = window.MyWorldAPI.state.skills || [];
            
            if (skills.length === 0) {
                sectionContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-code"></i>
                        <p>暂无技能</p>
                        <button onclick="openModal('skill')" class="btn-primary">添加技能</button>
                    </div>
                `;
                return;
            }
            
            sectionContent.innerHTML = `
                <div class="section-header">
                    <h2 class="section-title">技能管理</h2>
                    <button onclick="openModal('skill')" class="btn-secondary">
                        <i class="fas fa-plus mr-2"></i>添加技能
                    </button>
                </div>
                <div class="item-list">
                    ${skills.map(function(skill) {
                        return `
                        <div class="item-card">
                            <div class="item-header">
                                <div class="item-icon">
                                    <i class="fab ${skill.icon}"></i>
                                </div>
                                <div class="item-info">
                                    <div class="item-name">${skill.name}</div>
                                    <div class="item-description">熟练度: ${skill.proficiency}%</div>
                                </div>
                                <div class="item-actions">
                                    <button onclick="openModal('skill', '${skill.id}')" class="btn-action edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteItem('skill', '${skill.id}')" class="btn-action delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function loadToolsSection() {
            const sectionContent = document.getElementById('section-content');
            const tools = window.MyWorldAPI.state.tools || [];
            
            if (tools.length === 0) {
                sectionContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-tools"></i>
                        <p>暂无工具</p>
                        <button onclick="openModal('tool')" class="btn-primary">添加工具</button>
                    </div>
                `;
                return;
            }
            
            sectionContent.innerHTML = `
                <div class="section-header">
                    <h2 class="section-title">工具管理</h2>
                    <button onclick="openModal('tool')" class="btn-secondary">
                        <i class="fas fa-plus mr-2"></i>添加工具
                    </button>
                </div>
                <div class="item-list">
                    ${tools.map(function(tool) {
                        return `
                        <div class="item-card">
                            <div class="item-header">
                                <div class="item-icon">
                                    <i class="fas ${tool.icon}"></i>
                                </div>
                                <div class="item-info">
                                    <div class="item-name">${tool.name}</div>
                                    <div class="item-description">${tool.description}</div>
                                </div>
                                <div class="item-actions">
                                    <button onclick="openModal('tool', '${tool.id}')" class="btn-action edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteItem('tool', '${tool.id}')" class="btn-action delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function loadWebsitesSection() {
            const sectionContent = document.getElementById('section-content');
            const websites = window.MyWorldAPI.state.websites || [];
            
            if (websites.length === 0) {
                sectionContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-globe"></i>
                        <p>暂无网站</p>
                        <button onclick="openModal('website')" class="btn-primary">添加网站</button>
                    </div>
                `;
                return;
            }
            
            sectionContent.innerHTML = `
                <div class="section-header">
                    <h2 class="section-title">网站管理</h2>
                    <button onclick="openModal('website')" class="btn-secondary">
                        <i class="fas fa-plus mr-2"></i>添加网站
                    </button>
                </div>
                <div class="item-list">
                    ${websites.map(function(website) {
                        return `
                        <div class="item-card">
                            <div class="item-header">
                                <div class="item-icon">
                                    <i class="fab ${website.icon}"></i>
                                </div>
                                <div class="item-info">
                                    <div class="item-name">${website.name}</div>
                                    <div class="item-description">${website.description}</div>
                                </div>
                                <div class="item-actions">
                                    <button onclick="openModal('website', '${website.id}')" class="btn-action edit">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="deleteItem('website', '${website.id}')" class="btn-action delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        `;
                    }).join('')}
                </div>
            `;
        }

        function loadStatsSection() {
            const sectionContent = document.getElementById('section-content');
            const stats = window.MyWorldAPI.state.stats || {};
            
            sectionContent.innerHTML = `
                <h2 class="section-title mb-6">统计数据</h2>
                <form id="stats-form" class="space-y-4">
                    <div class="form-group">
                        <label class="form-label">年经验</label>
                        <input type="number" id="experience" name="experience" value="${stats.experience || 0}" min="0" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">项目完成</label>
                        <input type="number" id="projects" name="projects" value="${stats.projects || 0}" min="0" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">满意客户</label>
                        <input type="number" id="clients" name="clients" value="${stats.clients || 0}" min="0" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">代码提交</label>
                        <input type="number" id="commits" name="commits" value="${stats.commits || 0}" min="0" class="form-input" required>
                    </div>
                    <button type="submit" class="btn-primary">保存统计数据</button>
                </form>
            `;
            
            // Add form submit handler
            const form = document.getElementById('stats-form');
            form.addEventListener('submit', handleStatsSubmit);
        }

        function openModal(type, id) {
            const modal = document.getElementById('modal');
            const modalTitle = document.getElementById('modal-title');
            const modalBody = document.getElementById('modal-body');
            
            modal.classList.add('active');
            
            switch(type) {
                case 'project':
                    modalTitle.textContent = id ? '编辑项目' : '添加项目';
                    modalBody.innerHTML = getProjectForm(id);
                    break;
                case 'skill':
                    modalTitle.textContent = id ? '编辑技能' : '添加技能';
                    modalBody.innerHTML = getSkillForm(id);
                    break;
                case 'tool':
                    modalTitle.textContent = id ? '编辑工具' : '添加工具';
                    modalBody.innerHTML = getToolForm(id);
                    break;
                case 'website':
                    modalTitle.textContent = id ? '编辑网站' : '添加网站';
                    modalBody.innerHTML = getWebsiteForm(id);
                    break;
            }
        }

        function closeModal() {
            const modal = document.getElementById('modal');
            modal.classList.remove('active');
        }

        function getProjectForm(id) {
            const project = id ? window.MyWorldAPI.state.projects.find(function(p) {
                return p.id === id;
            }) : null;
            return `
                <form id="project-form" class="space-y-4">
                    <div class="form-group">
                        <label class="form-label">项目名称</label>
                        <input type="text" id="project-name" name="name" value="${project ? project.name : ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">项目描述</label>
                        <textarea id="project-description" name="description" rows="3" class="form-textarea" required>${project ? project.description : ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">图片URL</label>
                        <input type="url" id="project-image" name="image" value="${project ? project.image : ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">标签（用逗号分隔）</label>
                        <input type="text" id="project-tags" name="tags" value="${project ? project.tags.join(', ') : ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">项目链接</label>
                        <input type="url" id="project-link" name="link" value="${project ? project.link : '#'}" class="form-input" required>
                    </div>
                    <button type="submit" class="btn-primary">${id ? '更新项目' : '添加项目'}</button>
                </form>
            `;
        }

        function getSkillForm(id) {
            const skill = id ? window.MyWorldAPI.state.skills.find(function(s) {
                return s.id === id;
            }) : null;
            return `
                <form id="skill-form" class="space-y-4">
                    <div class="form-group">
                        <label class="form-label">技能名称</label>
                        <input type="text" id="skill-name" name="name" value="${skill ? skill.name : ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">熟练度 (%)</label>
                        <input type="number" id="skill-proficiency" name="proficiency" min="0" max="100" value="${skill ? skill.proficiency : 50}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">图标（Font Awesome）</label>
                        <input type="text" id="skill-icon" name="icon" value="${skill ? skill.icon : 'fa-code'}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">颜色</label>
                        <input type="color" id="skill-color" name="color" value="${skill ? skill.color : '#00F0FF'}" class="form-input" required>
                    </div>
                    <button type="submit" class="btn-primary">${id ? '更新技能' : '添加技能'}</button>
                </form>
            `;
        }

        function getToolForm(id) {
            const tool = id ? window.MyWorldAPI.state.tools.find(function(t) {
                return t.id === id;
            }) : null;
            return `
                <form id="tool-form" class="space-y-4">
                    <div class="form-group">
                        <label class="form-label">工具名称</label>
                        <input type="text" id="tool-name" name="name" value="${tool ? tool.name : ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">工具描述</label>
                        <textarea id="tool-description" name="description" rows="3" class="form-textarea" required>${tool ? tool.description : ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">图标（Font Awesome）</label>
                        <input type="text" id="tool-icon" name="icon" value="${tool ? tool.icon : 'fa-tools'}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">工具链接</label>
                        <input type="url" id="tool-link" name="link" value="${tool ? tool.link : '#'}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">颜色</label>
                        <input type="color" id="tool-color" name="color" value="${tool ? tool.color : '#00F0FF'}" class="form-input" required>
                    </div>
                    <button type="submit" class="btn-primary">${id ? '更新工具' : '添加工具'}</button>
                </form>
            `;
        }

        function getWebsiteForm(id) {
            const website = id ? window.MyWorldAPI.state.websites.find(function(w) {
                return w.id === id;
            }) : null;
            return `
                <form id="website-form" class="space-y-4">
                    <div class="form-group">
                        <label class="form-label">网站名称</label>
                        <input type="text" id="website-name" name="name" value="${website ? website.name : ''}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">网站描述</label>
                        <textarea id="website-description" name="description" rows="3" class="form-textarea" required>${website ? website.description : ''}</textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-label">图标（Font Awesome）</label>
                        <input type="text" id="website-icon" name="icon" value="${website ? website.icon : 'fa-globe'}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">网站链接</label>
                        <input type="url" id="website-link" name="link" value="${website ? website.link : '#'}" class="form-input" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">颜色</label>
                        <input type="color" id="website-color" name="color" value="${website ? website.color : '#00F0FF'}" class="form-input" required>
                    </div>
                    <button type="submit" class="btn-primary">${id ? '更新网站' : '添加网站'}</button>
                </form>
            `;
        }

        function handlePersonalSubmit(e) {
            e.preventDefault();
            showLoading();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            
            window.MyWorldAPI.state.personal = {
                ...window.MyWorldAPI.state.personal,
                ...data
            };
            
            saveData();
            hideLoading();
            showNotification('个人信息保存成功！', 'success');
            updateCounts();
        }

        function handleStatsSubmit(e) {
            e.preventDefault();
            showLoading();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            
            window.MyWorldAPI.state.stats = {
                experience: parseInt(data.experience),
                projects: parseInt(data.projects),
                clients: parseInt(data.clients),
                commits: parseInt(data.commits)
            };
            
            saveData();
            hideLoading();
            showNotification('统计数据保存成功！', 'success');
            updateCounts();
        }

        function handleFormSubmit(e) {
            e.preventDefault();
            showLoading();
            
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData);
            
            switch(e.target.id) {
                case 'project-form':
                    data.tags = data.tags ? data.tags.split(',').map(function(tag) {
                        return tag.trim();
                    }) : [];
                    data.image = data.image || 'https://picsum.photos/seed/' + Date.now() + '/800/600';
                    
                    if (e.target.querySelector('#project-name').value.includes('更新')) {
                        const id = e.target.querySelector('#project-name').getAttribute('data-id');
                        window.MyWorldAPI.updateProject(id, data);
                    } else {
                        window.MyWorldAPI.createProject(data);
                    }
                    break;
                case 'skill-form':
                    data.proficiency = parseInt(data.proficiency);
                    
                    if (e.target.querySelector('#skill-name').value.includes('更新')) {
                        const id = e.target.querySelector('#skill-name').getAttribute('data-id');
                        window.MyWorldAPI.updateSkill(id, data);
                    } else {
                        window.MyWorldAPI.createSkill(data);
                    }
                    break;
                case 'tool-form':
                    if (e.target.querySelector('#tool-name').value.includes('更新')) {
                        const id = e.target.querySelector('#tool-name').getAttribute('data-id');
                        window.MyWorldAPI.updateTool(id, data);
                    } else {
                        window.MyWorldAPI.createTool(data);
                    }
                    break;
                case 'website-form':
                    if (e.target.querySelector('#website-name').value.includes('更新')) {
                        const id = e.target.querySelector('#website-name').getAttribute('data-id');
                        window.MyWorldAPI.updateWebsite(id, data);
                    } else {
                        window.MyWorldAPI.createWebsite(data);
                    }
                    break;
            }
            
            saveData();
            hideLoading();
            showNotification('保存成功！', 'success');
            updateCounts();
            loadSectionContent(e.target.id.replace('-form', ''));
        }

        function deleteItem(type, id) {
            if (!confirm('确定要删除这个项目吗？')) return;
            
            showLoading();
            
            switch(type) {
                case 'project':
                    window.MyWorldAPI.deleteProject(id);
                    break;
                case 'skill':
                    window.MyWorldAPI.deleteSkill(id);
                    break;
                case 'tool':
                    window.MyWorldAPI.deleteTool(id);
                    break;
                case 'website':
                    window.MyWorldAPI.deleteWebsite(id);
                    break;
            }
            
            saveData();
            hideLoading();
            showNotification('删除成功！', 'success');
            updateCounts();
            loadSectionContent(type);
        }

        function saveData() {
            localStorage.setItem('myWorldData', JSON.stringify({
                personal: window.MyWorldAPI.state.personal,
                projects: window.MyWorldAPI.state.projects,
                skills: window.MyWorldAPI.state.skills,
                tools: window.MyWorldAPI.state.tools,
                websites: window.MyWorldAPI.state.websites,
                stats: window.MyWorldAPI.state.stats
            }));
        }

        function showLoading() {
            document.getElementById('loading').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loading').classList.remove('active');
        }

        function showNotification(message, type) {
            type = type || 'success';
            const notification = document.getElementById('notification');
            const icon = document.getElementById('notification-icon');
            const messageEl = document.getElementById('notification-message');
            
            icon.className = type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';
            notification.className = 'notification ' + type;
            messageEl.textContent = message;
            
            notification.classList.add('show');
            
            setTimeout(function() {
                notification.classList.remove('show');
            }, 3000);
        }

        // Listen for localStorage changes to update counts
        window.addEventListener('storage', function(e) {
            if (e.key === 'myWorldData' && e.newValue) {
                console.log('检测到数据变化，重新加载...');
                const newData = JSON.parse(e.newValue);
                window.MyWorldAPI.state.personal = newData.personal;
                window.MyWorldAPI.state.projects = newData.projects || [];
                window.MyWorldAPI.state.skills = newData.skills || [];
                window.MyWorldAPI.state.tools = newData.tools || [];
                window.MyWorldAPI.state.websites = newData.websites || [];
                window.MyWorldAPI.state.stats = newData.stats || {};
                
                updateCounts();
            }
        });

        // Modal close handler
        document.getElementById('modal-close').addEventListener('click', closeModal);
        document.getElementById('modal').addEventListener('click', function(e) {
            if (e.target.id === 'modal') {
                closeModal();
            }
        });
        
        // Form submit handlers
        document.addEventListener('submit', function(e) {
            if (e.target.id === 'project-form') {
                e.preventDefault();
                handleFormSubmit(e);
            } else if (e.target.id === 'skill-form') {
                e.preventDefault();
                handleFormSubmit(e);
            } else if (e.target.id === 'tool-form') {
                e.preventDefault();
                handleFormSubmit(e);
            } else if (e.target.id === 'website-form') {
                e.preventDefault();
                handleFormSubmit(e);
            }
        });
    </script>
</body>
</html>